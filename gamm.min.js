window.GAMM_IDS=[];class Gamm{constructor(e){if(this.template="",this.element=null,this.template_id="",this.template="",this.compiled_template="",this.data={},this.gamm_events={},this.options=[],this.stored_events={},this.compiled_events={},this.load=null,this.textareas={},this.properties={},this.gamm_element_and_events={},void 0!==e.file)this.template=this.read_template(e.file),this.convert_to_html();else if(void 0!==e.element){try{this.template=document.querySelectorAll(e.element)[0].innerHTML}catch(e){this.template=""}this.element=e.element,this.convert_to_html()}else this.template=e.template,this.convert_to_html();void 0!==e.data&&(this.data=e.data),void 0!==e.events&&(this.gamm_events=e.events),this.make_template_id(),void 0!==e.load&&(this.load=e.load),null!=this.element&&this.init_element()}convert_to_html(){var e=new DOMParser,t=e.parseFromString(this.template,"text/html");this.template=t.body.innerHTML}convert_to_text(e){var t=new DOMParser,a=t.parseFromString(this.template,"text/html"),i=a.body.innerText;return i}compile_events(){try{var e="";e=this.parse_data(this.compiled_template,'gamm-events="','"');for(var t=0,a=new RegExp("'","g");e.length>0;)try{var i="";i=JSON.parse(e[0].replace(a,'"'));var s="";for(var l in i){try{var m="data-gamm_"+l+'="'+this.template_id+"_"+t+'"',n="data_gamm_"+l+"_"+this.template_id+"_"+t;s+=m+" ",this.gamm_element_and_events[n]={element:"["+m+"]",event:i[l],on:l}}catch(e){console.log("ERROR EVENT: "+e)}t++}this.compiled_template=this.compiled_template.replace('gamm-events="'+e[0]+'"',s),e=this.parse_data(this.compiled_template,'gamm-events="','"')}catch(t){console.log(t),this.compiled_template=this.compiled_template.replace('gamm-events="'+e[0]+'"',"data-gamm='"+t+"'"),e=this.parse_data(this.compiled_template,'gamm-events="','"')}}catch(e){console.log(e)}}compile_datas(){try{for(var e=this.parse_data(this.compiled_template,"{{","}}");e.length>0;)try{this.compiled_template=this.compiled_template.replace("{{"+e[0]+"}}",this.data[e[0]]),e=this.parse_data(this.compiled_template,"{{","}}")}catch(t){console.log("ERROR DATA: "+t),this.compiled_template=this.compiled_template.replace("{{"+e[0]+"}}","[object-undefined]"),e=this.parse_data(this.compiled_template,"{{","}}")}}catch(e){console.log("ERROR DATA: "+e)}}compile_codes(){try{this.compiled_template=this.template;var gamm_start_identifier="&lt;#gamm",gamm_end_identifier="#&gt;",gamm_el_codes=this.parse_data(this.compiled_template,gamm_start_identifier,gamm_end_identifier),gamm_temp_code="",final_code_compiled="",gamm_final_code="",gamm_lt_tag_string=new RegExp("&lt;","g"),gamm_gt_tag_string=new RegExp("&gt;","g"),gamm_ampersand_string=new RegExp("&amp;","g"),gamm_double_quotes=new RegExp('"',"g"),gamm_start_brackets=new RegExp("{{","g"),gamm_end_brackets=new RegExp("}}","g");function gamm_echo(e){gamm_final_code+=e}function tag(e){gamm_final_code+="<"+e+">"}for(;gamm_el_codes.length>0;)try{gamm_temp_code=gamm_el_codes[0],gamm_temp_code=gamm_temp_code.replace(gamm_double_quotes,'\\"');for(var start_lt_tag=!1,i=0;i<gamm_temp_code.length;i++){var str_1=gamm_temp_code[i];"<"==str_1&&0==start_lt_tag?(final_code_compiled+=' gamm_echo("'+str_1,start_lt_tag=!0):1==start_lt_tag&&"\n"==str_1?(final_code_compiled+='");'+str_1,start_lt_tag=!1):final_code_compiled+=str_1}for(var tags_with_brackets_compile=this.parse_data(final_code_compiled,"<",">");tags_with_brackets_compile.length>0;){var replacement_string="&lt;"+tags_with_brackets_compile[0].replace(gamm_start_brackets,'" + ').replace(gamm_end_brackets,' + "')+"&gt;";final_code_compiled=final_code_compiled.replace("<"+tags_with_brackets_compile[0]+">",replacement_string),tags_with_brackets_compile=this.parse_data(final_code_compiled,"<",">")}final_code_compiled=final_code_compiled.replace(gamm_lt_tag_string,"<").replace(gamm_gt_tag_string,">").replace(gamm_ampersand_string,"&").replace(gamm_start_brackets,"gamm_echo(").replace(gamm_end_brackets,");"),eval(final_code_compiled),this.compiled_template=this.compiled_template.replace(gamm_start_identifier+gamm_el_codes[0]+gamm_end_identifier,gamm_final_code),gamm_el_codes=this.parse_data(this.compiled_template,gamm_start_identifier,gamm_end_identifier)}catch(e){console.log("ERROR CODE: "+e),this.compiled_template=this.compiled_template.replace(gamm_start_identifier+gamm_el_codes[0]+gamm_end_identifier,"[object-undefined]"),gamm_el_codes=this.parse_data(this.compiled_template,gamm_start_identifier,gamm_end_identifier)}}catch(e){console.log("ERROR CODES: "+e)}}compile_models(){try{for(var e=this,t=document.querySelectorAll("#"+this.template_id+" [name]"),a=0;a<t.length;a++){var i=t[a];if("INPUT"!=i.tagName||"radio"!=i.type&&"checkbox"!=i.type)i.value=this.data[i.name];else if("checkbox"==i.type||"radio"==i.type)for(var s=document.querySelectorAll("#"+this.template_id+" [name='"+i.name+"']"),l=0;l<s.length;l++)this.data[i.name].indexOf(s[l].value)>-1?s[l].checked=!0:s[l].checked=!1;try{"TEXTAREA"==i.tagName&&void 0!==this.textareas[i.name]&&(document.querySelectorAll("[name='"+i.name+"']")[0].style.width=this.textareas[i.name].width,document.querySelectorAll("[name='"+i.name+"']")[0].style.height=this.textareas[i.name].height)}catch(e){console.log(e)}"TEXTAREA"==i.tagName&&(i.onmouseup=function(){void 0===e.textareas[this.name]&&(e.textareas[this.name]={width:this.style.width,height:this.style.height}),this.style.width==e.textareas[this.name].width&&this.style.height==e.textareas[this.name].height||(e.textareas[this.name].height=this.style.height,e.textareas[this.name].width=this.style.width)}),i.onkeyup=function(){for(var t=document.querySelectorAll("#"+e.template_id+" [name='"+this.name+"']"),i=0,s=0;s<t.length;s++)this==t[a]&&(i=a);if("radio"==this.type||"checkbox"==this.type){if("radio"==this.type)this.checked&&(e.data[this.name]=this.value);else if(this.checked)e.data[this.name].indexOf(this.value)<0&&e.data[this.name].push(this.value);else{var l=e.data[this.name].indexOf(this.value);e.data[this.name].splice(l,1)}e.reload.call(e),e.focus(document.querySelectorAll("#"+e.template_id+" [name='"+this.name+"']")[i])}else this.value!=e.data[this.name]&&(e.data[this.name]=this.value,e.reload.call(e),e.focus(document.querySelectorAll("#"+e.template_id+" [name='"+this.name+"']")[i]))},i.onchange=function(){for(var t=document.querySelectorAll("#"+e.template_id+" [name='"+this.name+"']"),i=0,s=0;s<t.length;s++)this==t[a]&&(i=a);if("radio"==this.type||"checkbox"==this.type){if("radio"==this.type)this.checked&&(e.data[this.name]=this.value);else if(this.checked)e.data[this.name].indexOf(this.value)<0&&e.data[this.name].push(this.value);else{var l=e.data[this.name].indexOf(this.value);e.data[this.name].splice(l,1)}e.reload.call(e),e.focus(document.querySelectorAll("#"+e.template_id+" [name='"+this.name+"']")[i])}else this.value!=e.data[this.name]&&(e.data[this.name]=this.value,e.reload.call(e),e.focus(document.querySelectorAll("#"+e.template_id+" [name='"+this.name+"']")[i]))}}}catch(e){console.log(e)}}distribute_events(){var $this=this;try{for(var index in this.gamm_element_and_events)eval("document.querySelector('"+this.gamm_element_and_events[index].element+"').on"+this.gamm_element_and_events[index].on+" = function($event){ \t\t\t\t\t\t$this.gamm_events."+this.gamm_element_and_events[index].event+".call($this,this,$event); \t\t\t\t\t\tif($this.element != null){ \t\t\t\t\t\t\t$this.init_element.call($this); \t\t\t\t\t\t}else{ \t\t\t\t\t\t\t$this.reload.call($this); \t\t\t\t\t\t} \t\t\t\t\t};")}catch(e){console.log("ERROR EVENT: "+e)}}parse_data(e,t,a){for(var i=e.length,s=[],l=0,m=t.length,n=a.length,o=0;o<i;o++)if(0!=m){var d=e.substr(o,m);if(d==t)for(var c=0,h=o+m;h<i;h++)if(c++,h<i){var _=e.substr(h,n);if(_==a){var r=e.substr(o+m,c-1);s[l]=r,l++,o=o+m+(c-1),h=i}}}return s}read_template(e,t="GET"){var a=null,i="";return a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),a.onreadystatechange=function(){4==this.readyState&&200==this.status&&(i=a.responseText)},a.open(t,e,!1),a.send(),i}make_template_id(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",a=t.length,i=0;i<10;i++)e+=t.charAt(Math.floor(Math.random()*a));window.GAMM_IDS.indexOf(e)>-1?this.make_template_id():(this.template_id=e,window.GAMM_IDS[window.GAMM_IDS.length]=e)}prepend_to(e){null!==this.load&&this.load.call(this),this.compile_codes(),this.compile_events(),this.compile_datas();try{document.querySelector(e).innerHTML="<div id='"+this.template_id+"'>"+this.compiled_template+"</div>"+document.querySelector(e).innerHTML}catch(e){this.template=""}this.distribute_events(),this.compile_models()}append_to(e){null!==this.load&&this.load.call(this),this.compile_codes(),this.compile_events(),this.compile_datas();try{document.querySelector(e).innerHTML+="<div id='"+this.template_id+"'>"+this.compiled_template+"</div>"}catch(e){this.template=""}this.distribute_events(),this.compile_models()}insert_to(e){null!==this.load&&this.load.call(this),this.compile_codes(),this.compile_events(),this.compile_datas();try{document.querySelector(e).innerHTML="<div id='"+this.template_id+"'>"+this.compiled_template+"</div>"}catch(e){this.template=""}this.distribute_events(),this.compile_models()}init_element(){null!==this.load&&this.load.call(this),this.compile_codes(),this.compile_events(),this.compile_datas();try{document.querySelector(this.element).innerHTML="<div id='"+this.template_id+"'>"+this.compiled_template+"</div>"}catch(e){this.template=""}this.distribute_events(),this.compile_models()}reload(){null!==this.load&&this.load.call(this),this.compile_codes(),this.compile_events(),this.compile_datas(),document.querySelector("#"+this.template_id).innerHTML=this.compiled_template,this.distribute_events(),this.compile_models()}get_data(){return"<div id='"+this.template_id+"'>"+this.compiled_template+"</div>"}other(e,t,a){e.data[t]=a,e.reload.call(e)}focus(e){var t,a="onfocusin"in e?"focusin":"focus",i="onfocusin"in e;"createEvent"in document?(t=document.createEvent("Event"),t.initEvent(a,i,!0)):"Event"in window&&(t=new Event(a,{bubbles:i,cancelable:!0})),e.focus(),e.dispatchEvent(t)}static append(e,t){document.querySelector(e).innerHTML+=t}static prepend(e,t){document.querySelector(e).innerHTML=t+document.querySelector(e).innerHTML}}