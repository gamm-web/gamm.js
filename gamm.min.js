window.GAMM_IDS=[];class Gamm{constructor(t){if(this.template="",this.element=null,this.template_id="",this.template="",this.compiled_template="",this.data={},this.gamm_events={},this.options=[],this.stored_events={},this.compiled_events={},this.load=null,this.textareas={},this.properties={},this.gamm_element_and_events={},void 0!==t.file)this.template=this.read_template(t.file),this.convert_to_html();else if(void 0!==t.element){try{this.template=document.querySelectorAll(t.element)[0].innerHTML}catch(t){this.template=""}this.element=t.element,this.convert_to_html()}else this.template=t.template,this.convert_to_html();void 0!==t.data&&(this.data=t.data),void 0!==t.events&&(this.gamm_events=t.events),this.make_template_id(),void 0!==t.load&&(this.load=t.load),null!=this.element&&this.init_element()}convert_to_html(){var t=new DOMParser,e=t.parseFromString(this.template,"text/html");this.template=e.body.innerHTML}convert_to_text(t){var e=new DOMParser,a=e.parseFromString(this.template,"text/html"),i=a.body.innerText;return i}compile_events(){try{var t="";t=this.parse_data(this.compiled_template,'gamm-events="','"');for(var e=0,a=new RegExp("'","g");t.length>0;)try{var i="";i=JSON.parse(t[0].replace(a,'"'));var m="";for(var s in i){try{var l="data-gamm_"+s+'="'+this.template_id+"_"+e+'"',n="data_gamm_"+s+"_"+this.template_id+"_"+e;m+=l+" ",this.gamm_element_and_events[n]={element:"["+l+"]",event:i[s],on:s}}catch(t){console.log("ERROR EVENT: "+t)}e++}this.compiled_template=this.compiled_template.replace('gamm-events="'+t[0]+'"',m),t=this.parse_data(this.compiled_template,'gamm-events="','"')}catch(e){console.log(e),this.compiled_template=this.compiled_template.replace('gamm-events="'+t[0]+'"',"data-gamm='"+e+"'"),t=this.parse_data(this.compiled_template,'gamm-events="','"')}}catch(t){console.log(t)}}compile_datas(){try{for(var t=this.parse_data(this.compiled_template,"{{","}}");t.length>0;)try{this.compiled_template=this.compiled_template.replace("{{"+t[0]+"}}",this.data[t[0]]),t=this.parse_data(this.compiled_template,"{{","}}")}catch(e){console.log("ERROR DATA: "+e),this.compiled_template=this.compiled_template.replace("{{"+t[0]+"}}","[object-undefined]"),t=this.parse_data(this.compiled_template,"{{","}}")}}catch(t){console.log("ERROR DATA: "+t)}}compile_codes(){try{this.compiled_template=this.template;var gamm_start_identifier="&lt;#gamm",gamm_end_identifier="#&gt;",gamm_el_codes=this.parse_data(this.compiled_template,gamm_start_identifier,gamm_end_identifier),gamm_temp_code="",final_code_compiled="",gamm_final_code="",gamm_lt_tag_string=new RegExp("&lt;","g"),gamm_gt_tag_string=new RegExp("&gt;","g"),gamm_ampersand_string=new RegExp("&amp;","g"),gamm_double_quotes=new RegExp('"',"g"),gamm_start_brackets=new RegExp("{{","g"),gamm_end_brackets=new RegExp("}}","g");function gamm_echo(t){gamm_final_code+=t}function tag(t){gamm_final_code+="<"+t+">"}for(;gamm_el_codes.length>0;)try{gamm_temp_code=gamm_el_codes[0],gamm_temp_code=gamm_temp_code.replace(gamm_double_quotes,'\\"');for(var start_lt_tag=!1,i=0;i<gamm_temp_code.length;i++){var str_1=gamm_temp_code[i];"<"==str_1&&0==start_lt_tag?(final_code_compiled+=' gamm_echo("'+str_1,start_lt_tag=!0):1==start_lt_tag&&"\n"==str_1?(final_code_compiled+='");'+str_1,start_lt_tag=!1):final_code_compiled+=str_1}for(var tags_with_brackets_compile=this.parse_data(final_code_compiled,"<",">");tags_with_brackets_compile.length>0;){var replacement_string="&lt;"+tags_with_brackets_compile[0].replace(gamm_start_brackets,'" + ').replace(gamm_end_brackets,' + "')+"&gt;";final_code_compiled=final_code_compiled.replace("<"+tags_with_brackets_compile[0]+">",replacement_string),tags_with_brackets_compile=this.parse_data(final_code_compiled,"<",">")}final_code_compiled=final_code_compiled.replace(gamm_lt_tag_string,"<").replace(gamm_gt_tag_string,">").replace(gamm_ampersand_string,"&").replace(gamm_start_brackets,"gamm_echo(").replace(gamm_end_brackets,");"),eval(final_code_compiled),this.compiled_template=this.compiled_template.replace(gamm_start_identifier+gamm_el_codes[0]+gamm_end_identifier,gamm_final_code),gamm_el_codes=this.parse_data(this.compiled_template,gamm_start_identifier,gamm_end_identifier)}catch(t){console.log("ERROR CODE: "+t),this.compiled_template=this.compiled_template.replace(gamm_start_identifier+gamm_el_codes[0]+gamm_end_identifier,"[object-undefined]"),gamm_el_codes=this.parse_data(this.compiled_template,gamm_start_identifier,gamm_end_identifier)}}catch(t){console.log("ERROR CODES: "+t)}}compile_models(){try{for(var t=this,e=document.querySelectorAll("[name]"),a=0;a<e.length;a++){var i=e[a];i.value=this.data[i.name];try{"TEXTAREA"==i.tagName&&void 0!==this.textareas[i.name]&&(document.querySelectorAll("[name='"+i.name+"']")[0].style.width=this.textareas[i.name].width,document.querySelectorAll("[name='"+i.name+"']")[0].style.height=this.textareas[i.name].height)}catch(t){console.log(t)}"TEXTAREA"==i.tagName&&(i.onmouseup=function(){void 0===t.textareas[this.name]&&(t.textareas[this.name]={width:this.style.width,height:this.style.height}),this.style.width==t.textareas[this.name].width&&this.style.height==t.textareas[this.name].height||(t.textareas[this.name].height=this.style.height,t.textareas[this.name].width=this.style.width)}),i.onkeyup=function(){this.value!=t.data[this.name]&&(t.data[this.name]=this.value,t.reload.call(t),t.focus(document.querySelectorAll("[name='"+this.name+"']")[0]))},i.onchange=function(){this.value!=t.data[this.name]&&(t.data[this.name]=this.value,t.reload.call(t),t.focus(document.querySelectorAll("[name='"+this.name+"']")[0]))}}}catch(t){console.log(t)}}distribute_events(){var $this=this;try{for(var index in this.gamm_element_and_events)eval("document.querySelector('"+this.gamm_element_and_events[index].element+"').on"+this.gamm_element_and_events[index].on+" = function($event){ \t\t\t\t\t\t$this.gamm_events."+this.gamm_element_and_events[index].event+".call($this,this,$event); \t\t\t\t\t\tif($this.element != null){ \t\t\t\t\t\t\t$this.init_element.call($this); \t\t\t\t\t\t}else{ \t\t\t\t\t\t\t$this.reload.call($this); \t\t\t\t\t\t} \t\t\t\t\t};")}catch(t){console.log("ERROR EVENT: "+t)}}parse_data(t,e,a){for(var i=t.length,m=[],s=0,l=e.length,n=a.length,_=0;_<i;_++)if(0!=l){var o=t.substr(_,l);if(o==e)for(var c=0,d=_+l;d<i;d++)if(c++,d<i){var r=t.substr(d,n);if(r==a){var h=t.substr(_+l,c-1);m[s]=h,s++,_=_+l+(c-1),d=i}}}return m}read_template(t,e="GET"){var a=null,i="";return a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),a.onreadystatechange=function(){4==this.readyState&&200==this.status&&(i=a.responseText)},a.open(e,t,!1),a.send(),i}make_template_id(){for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",a=e.length,i=0;i<10;i++)t+=e.charAt(Math.floor(Math.random()*a));window.GAMM_IDS.indexOf(t)>-1?this.make_template_id():this.template_id=t}append_to(t){null!==this.load&&this.load.call(this),this.compile_codes(),this.compile_events(),this.compile_datas();try{document.querySelector(t).innerHTML+="<div id='"+this.template_id+"'>"+this.compiled_template+"</div>"}catch(t){this.template=""}this.distribute_events(),this.compile_models()}init_element(){null!==this.load&&this.load.call(this),this.compile_codes(),this.compile_events(),this.compile_datas();try{document.querySelector(this.element).innerHTML="<div id='"+this.template_id+"'>"+this.compiled_template+"</div>"}catch(t){this.template=""}this.distribute_events(),this.compile_models()}reload(){null!==this.load&&this.load.call(this),this.compile_codes(),this.compile_events(),this.compile_datas(),document.querySelector("#"+this.template_id).innerHTML=this.compiled_template,this.distribute_events(),this.compile_models()}get_data(){return"<div id='"+this.template_id+"'>"+this.compiled_template+"</div>"}other(t,e,a){t.data[e]=a,t.reload.call(t)}focus(t){var e,a="onfocusin"in t?"focusin":"focus",i="onfocusin"in t;"createEvent"in document?(e=document.createEvent("Event"),e.initEvent(a,i,!0)):"Event"in window&&(e=new Event(a,{bubbles:i,cancelable:!0})),t.focus(),t.dispatchEvent(e)}static append(t,e){document.querySelector(t).innerHTML+=e}}