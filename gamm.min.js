window.GAMM_IDS=[];class Gamm{constructor(e){if(this.template="",this.element=null,this.template_id="",this.template="",this.compiled_template="",this.data={},this.gamm_events={},this.options=[],this.stored_events={},this.compiled_events={},this.load=null,this.textareas={},this.properties={},this.gamm_element_and_events={},void 0!==e.file)this.template=this.read_template(e.file),this.convert_to_html();else if(void 0!==e.element){try{this.template=document.querySelectorAll(e.element)[0].innerHTML}catch(e){this.template=""}this.element=e.element,this.convert_to_html()}else this.template=e.template,this.convert_to_html();void 0!==e.data&&(this.data=e.data),void 0!==e.events&&(this.gamm_events=e.events),this.make_template_id(),void 0!==e.load&&(this.load=e.load),null!=this.element&&this.init_element(),this.http={post:function(e,t={}){var a="POST",i=e,s=!1,m=null,l="",d="";if(void 0!==t.data)if("object"==typeof t.data){for(var o in t.data)d+=o+"="+encodeURI(t.data[o])+"&";d=d.substring(0,d.length-1)}else d=t.data;m=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),m.onreadystatechange=function(){4==this.readyState&&200==this.status?(s||(l=m),void 0!==t.success&&t.success(m)):4==this.readyState&&200!=this.status&&void 0!==t.error&&t.error(m)},m.open(a,i,s);var n=!1;if(void 0!==t.headers)for(var o in t.headers)m.setRequestHeader(o,t.headers[o]),o.toLowerCase().indexOf("content-type")>-1&&0==n&&(n=!0);if(void 0!==t.data?(n||m.setRequestHeader("Content-type","application/x-www-form-urlencoded"),m.send(d)):m.send(),!s)return l},get:function(e,t={}){var a="GET",i=e,s=!1,m=null,l="",d="";if(void 0!==t.data)if("object"==typeof t.data){for(var o in t.data)d+=o+"="+encodeURI(t.data[o])+"&";d=d.substring(0,d.length-1)}else d=t.data;m=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),m.onreadystatechange=function(){4==this.readyState&&200==this.status?(s||(l=m),void 0!==t.success&&t.options(m)):4==this.readyState&&200!=this.status&&void 0!==t.error&&t.error(m)},m.open(a,i,s);var n=!1;if(void 0!==t.headers)for(var o in t.headers)m.setRequestHeader(o,t.headers[o]),o.toLowerCase().indexOf("content-type")>-1&&0==n&&(n=!0);if(void 0!==t.data?(n||m.setRequestHeader("Content-type","application/x-www-form-urlencoded"),m.send(d)):m.send(),!s)return l},request:function(e,t={}){var a="POST",i=e,s=!1,m=null,l="",d="";if(void 0!==t.method&&(a=t.method),void 0!==t.data)if("object"==typeof t.data){for(var o in t.data)d+=o+"="+encodeURI(t.data[o])+"&";d=d.substring(0,d.length-1)}else d=t.data;m=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),m.onreadystatechange=function(){4==this.readyState&&200==this.status?(s||(l=m),void 0!==t.success&&t.success(m)):4==this.readyState&&200!=this.status&&void 0!==t.error&&t.error(m)},m.open(a,i,s);var n=!1;if(void 0!==t.headers)for(var o in t.headers)m.setRequestHeader(o,t.headers[o]),o.toLowerCase().indexOf("content-type")>-1&&0==n&&(n=!0);if(void 0!==t.data?(n||m.setRequestHeader("Content-type","application/x-www-form-urlencoded"),m.send(d)):m.send(),!s)return l}}}convert_to_html(){var e=new DOMParser,t=e.parseFromString(this.template,"text/html");this.template=t.body.innerHTML}convert_to_text(e){var t=new DOMParser,a=t.parseFromString(this.template,"text/html"),i=a.body.innerText;return i}compile_events(){try{var e="";e=this.parse_data(this.compiled_template,'gamm-events="','"');for(var t=0,a=new RegExp("'","g");e.length>0;)try{var i="";i=JSON.parse(e[0].replace(a,'"'));var s="";for(var m in i){try{var l="data-gamm_"+m+'="'+this.template_id+"_"+t+'"',d="data_gamm_"+m+"_"+this.template_id+"_"+t;s+=l+" ",this.gamm_element_and_events[d]={element:"["+l+"]",event:i[m],on:m}}catch(e){console.log("ERROR EVENT: "+e)}t++}this.compiled_template=this.compiled_template.replace('gamm-events="'+e[0]+'"',s),e=this.parse_data(this.compiled_template,'gamm-events="','"')}catch(t){console.log(t),this.compiled_template=this.compiled_template.replace('gamm-events="'+e[0]+'"',"data-gamm='"+t+"'"),e=this.parse_data(this.compiled_template,'gamm-events="','"')}}catch(e){console.log(e)}}compile_datas(){try{for(var gamm_el_datas=this.parse_data(this.compiled_template,"{{","}}");gamm_el_datas.length>0;)try{this.compiled_template=this.compiled_template.replace("{{"+gamm_el_datas[0]+"}}",eval("this.data."+gamm_el_datas[0])),gamm_el_datas=this.parse_data(this.compiled_template,"{{","}}")}catch(e){console.log("ERROR DATA: "+e),this.compiled_template=this.compiled_template.replace("{{"+gamm_el_datas[0]+"}}","[object-undefined]"),gamm_el_datas=this.parse_data(this.compiled_template,"{{","}}")}}catch(e){console.log("ERROR DATA: "+e)}}compile_codes(){try{this.compiled_template=this.template;var gamm_start_identifier="&lt;#gamm",gamm_end_identifier="#&gt;",gamm_el_codes=this.parse_data(this.compiled_template,gamm_start_identifier,gamm_end_identifier),gamm_temp_code="",final_code_compiled="",gamm_final_code="",gamm_lt_tag_string=new RegExp("&lt;","g"),gamm_gt_tag_string=new RegExp("&gt;","g"),gamm_ampersand_string=new RegExp("&amp;","g"),gamm_double_quotes=new RegExp('"',"g"),gamm_start_brackets=new RegExp("{{","g"),gamm_end_brackets=new RegExp("}}","g");function gamm_echo(e){gamm_final_code+=e}function tag(e){gamm_final_code+="<"+e+">"}function $(e){gamm_final_code+="<"+e+">"}function $$(e){gamm_final_code+="</"+e+">"}for(;gamm_el_codes.length>0;)try{gamm_temp_code=gamm_el_codes[0],gamm_temp_code=gamm_temp_code.replace(gamm_double_quotes,'\\"');for(var start_lt_tag=!1,i=0;i<gamm_temp_code.length;i++){var str_1=gamm_temp_code[i];"<"==str_1&&0==start_lt_tag?(final_code_compiled+=' gamm_echo("'+str_1,start_lt_tag=!0):1==start_lt_tag&&"\n"==str_1?(final_code_compiled+='");'+str_1,start_lt_tag=!1):final_code_compiled+=str_1}for(var tags_with_brackets_compile=this.parse_data(final_code_compiled,"<",">");tags_with_brackets_compile.length>0;){var replacement_string="&lt;"+tags_with_brackets_compile[0].replace(gamm_start_brackets,'" + ').replace(gamm_end_brackets,' + "')+"&gt;";final_code_compiled=final_code_compiled.replace("<"+tags_with_brackets_compile[0]+">",replacement_string),tags_with_brackets_compile=this.parse_data(final_code_compiled,"<",">")}final_code_compiled=final_code_compiled.replace(gamm_lt_tag_string,"<").replace(gamm_gt_tag_string,">").replace(gamm_ampersand_string,"&").replace(gamm_start_brackets,"gamm_echo(").replace(gamm_end_brackets,");"),eval(final_code_compiled),this.compiled_template=this.compiled_template.replace(gamm_start_identifier+gamm_el_codes[0]+gamm_end_identifier,gamm_final_code),gamm_el_codes=this.parse_data(this.compiled_template,gamm_start_identifier,gamm_end_identifier)}catch(e){console.log("ERROR CODE: "+e),this.compiled_template=this.compiled_template.replace(gamm_start_identifier+gamm_el_codes[0]+gamm_end_identifier,"[object-undefined]"),gamm_el_codes=this.parse_data(this.compiled_template,gamm_start_identifier,gamm_end_identifier)}}catch(e){console.log("ERROR CODES: "+e)}}compile_models(){try{for(var $this=this,gamm_models=document.querySelectorAll("#"+this.template_id+" [name]"),i=0;i<gamm_models.length;i++){var gamm_value="",gamm_model=gamm_models[i];if(gamm_value=eval("this.data."+gamm_model.name),"INPUT"!=gamm_model.tagName||"radio"!=gamm_model.type&&"checkbox"!=gamm_model.type)gamm_model.value=gamm_value;else if("checkbox"==gamm_model.type||"radio"==gamm_model.type)for(var boxes=document.querySelectorAll("#"+this.template_id+" [name='"+gamm_model.name+"']"),j=0;j<boxes.length;j++)gamm_value.indexOf(boxes[j].value)>-1?boxes[j].checked=!0:boxes[j].checked=!1;try{"TEXTAREA"==gamm_model.tagName&&void 0!==this.textareas[gamm_model.name]&&(document.querySelectorAll("[name='"+gamm_model.name+"']")[0].style.width=this.textareas[gamm_model.name].width,document.querySelectorAll("[name='"+gamm_model.name+"']")[0].style.height=this.textareas[gamm_model.name].height)}catch(e){console.log(e)}"TEXTAREA"==gamm_model.tagName&&(gamm_model.onmouseup=function(){void 0===$this.textareas[this.name]&&($this.textareas[this.name]={width:this.style.width,height:this.style.height}),this.style.width==$this.textareas[this.name].width&&this.style.height==$this.textareas[this.name].height||($this.textareas[this.name].height=this.style.height,$this.textareas[this.name].width=this.style.width)}),gamm_model.onkeyup=function(){for(var similiar_elems=document.querySelectorAll("#"+$this.template_id+" [name='"+this.name+"']"),index_elem=0,gamm_data=eval("$this.data."+this.name),elem_i=0;elem_i<similiar_elems.length;elem_i++)this==similiar_elems[i]&&(index_elem=i);if("radio"==this.type||"checkbox"==this.type){if("radio"==this.type)this.checked&&eval("$this.data."+this.name+" = this.value;");else if(this.checked)gamm_data.indexOf(this.value)<0&&eval("$this.data."+this.name+".push(this.value);");else{var index=gamm_data.indexOf(this.value);eval("$this.data."+this.name+".splice(index,1);")}$this.reload.call($this),$this.focus(document.querySelectorAll("#"+$this.template_id+" [name='"+this.name+"']")[index_elem])}else this.value!=gamm_data&&(eval("$this.data."+this.name+"= this.value;"),$this.reload.call($this),$this.focus(document.querySelectorAll("#"+$this.template_id+" [name='"+this.name+"']")[index_elem]))},gamm_model.onchange=function(){for(var similiar_elems=document.querySelectorAll("#"+$this.template_id+" [name='"+this.name+"']"),index_elem=0,gamm_data=eval("$this.data."+this.name),elem_i=0;elem_i<similiar_elems.length;elem_i++)this==similiar_elems[i]&&(index_elem=i);if("radio"==this.type||"checkbox"==this.type){if("radio"==this.type)this.checked&&eval("$this.data."+this.name+" = this.value;");else if(this.checked)gamm_data.indexOf(this.value)<0&&eval("$this.data."+this.name+".push(this.value);");else{var index=gamm_data.indexOf(this.value);eval("$this.data."+this.name+".splice(index,1);")}$this.reload.call($this),$this.focus(document.querySelectorAll("#"+$this.template_id+" [name='"+this.name+"']")[index_elem])}else this.value!=gamm_data&&(eval("$this.data."+this.name+"= this.value;"),$this.reload.call($this),$this.focus(document.querySelectorAll("#"+$this.template_id+" [name='"+this.name+"']")[index_elem]))}}}catch(e){console.log(e)}}distribute_events(){var $this=this;try{for(var index in this.gamm_element_and_events)eval("document.querySelector('"+this.gamm_element_and_events[index].element+"').on"+this.gamm_element_and_events[index].on+" = function($event){ \t\t\t\t\t\t$this.gamm_events."+this.gamm_element_and_events[index].event+".call($this,this,$event); \t\t\t\t\t\tif($this.element != null){ \t\t\t\t\t\t\t$this.init_element.call($this); \t\t\t\t\t\t}else{ \t\t\t\t\t\t\t$this.reload.call($this); \t\t\t\t\t\t} \t\t\t\t\t};")}catch(e){console.log("ERROR EVENT: "+e)}}parse_data(e,t,a){for(var i=e.length,s=[],m=0,l=t.length,d=a.length,o=0;o<i;o++)if(0!=l){var n=e.substr(o,l);if(n==t)for(var _=0,h=o+l;h<i;h++)if(_++,h<i){var r=e.substr(h,d);if(r==a){var c=e.substr(o+l,_-1);s[m]=c,m++,o=o+l+(_-1),h=i}}}return s}read_template(e,t="GET"){var a=null,i="";return a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),a.onreadystatechange=function(){4==this.readyState&&200==this.status&&(i=a.responseText)},a.open(t,e,!1),a.send(),i}make_template_id(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",a=t.length,i=0;i<10;i++)e+=t.charAt(Math.floor(Math.random()*a));window.GAMM_IDS.indexOf(e)>-1?this.make_template_id():(this.template_id=e,window.GAMM_IDS[window.GAMM_IDS.length]=e)}prepend_to(e){null!==this.load&&this.load.call(this),this.compile_codes(),this.compile_events(),this.compile_datas();try{var t=document.createElement("div");t.id=this.template_id,t.innerHTML=this.compiled_template,document.querySelector(e).prepend(t)}catch(e){this.template=""}this.distribute_events(),this.compile_models()}append_to(e){null!==this.load&&this.load.call(this),this.compile_codes(),this.compile_events(),this.compile_datas();try{var t=document.createElement("div");t.id=this.template_id,t.innerHTML=this.compiled_template,document.querySelector(e).append(t)}catch(e){this.template=""}this.distribute_events(),this.compile_models()}insert_to(e){null!==this.load&&this.load.call(this),this.compile_codes(),this.compile_events(),this.compile_datas();try{document.querySelector(e).innerHTML="<div id='"+this.template_id+"'>"+this.compiled_template+"</div>"}catch(e){this.template=""}this.distribute_events(),this.compile_models()}init_element(){null!==this.load&&this.load.call(this),this.compile_codes(),this.compile_events(),this.compile_datas();try{document.querySelector(this.element).innerHTML="<div id='"+this.template_id+"'>"+this.compiled_template+"</div>"}catch(e){this.template=""}this.distribute_events(),this.compile_models()}reload(){null!==this.load&&this.load.call(this),this.compile_codes(),this.compile_events(),this.compile_datas(),document.querySelector("#"+this.template_id).innerHTML=this.compiled_template,this.distribute_events(),this.compile_models()}get_data(){return"<div id='"+this.template_id+"'>"+this.compiled_template+"</div>"}other($class,$data,$value){eval("$class."+$data+" = $value"),$class.reload.call($class)}focus(e){var t,a="onfocusin"in e?"focusin":"focus",i="onfocusin"in e;"createEvent"in document?(t=document.createEvent("Event"),t.initEvent(a,i,!0)):"Event"in window&&(t=new Event(a,{bubbles:i,cancelable:!0})),e.focus(),e.dispatchEvent(t)}}